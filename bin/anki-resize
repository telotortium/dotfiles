#!/bin/sh -e

resize () {
    convert "$1" -fill white -opaque none "png:-" | \
        convert "png:-" -resize '400x400>' "$2"
}

if [ $# -eq 1 ]; then
    tmp=$(mktemp)
    ( pngpaste "$tmp" && resize "png:${tmp}" "$1" )
    rv=$?
    rm -f "$tmp"
    exit "$rv"
else
    resize "$1" "$2"
fi
